1. ¿Cuales son los productos mas comprados por un cliente?

MATCH (c:Cliente {idCliente: 1})-[:HA_CREADO]->(o:Orden)-[r:ESTA_COMPUESTA_DE]->(p:Producto)
RETURN p.nombre AS producto, SUM(r.cantidad) AS Total_Comprado
ORDER Total_Comprado DESC


2. ¿Cuáles son los productos más demandados por los clientes de un sexo (hombre/mujer)?

MATCH (c:Cliente {sexo: "F"})-[:HA_CREADO]->(o:Orden)-[r:ESTA_COMPUESTA_DE]->(p:Producto)
RETURN p.nombre AS producto, SUM(r.cantidad) AS Total_Demandado
ORDER BY Total_Demandado DESC


3. ¿Cuáles son los principales productos comprados por los clientes que tiene un título académico?

MATCH (c:Cliente {tieneTitulo: true})-[:HA_CREADO]->(o:Orden)-[r:ESTA_COMPUESTA_DE]->(p:Producto)
RETURN p.nombre AS producto, SUM(r.cantidad) AS Total_Comprado
ORDER BY Total_Comprado DESC

4. ¿Cuáles son los productos comprados por los clientes que viven en la misma ciudad del proveedor?

MATCH (c:Cliente)-[:VIVE_EN]->(ciudad:Ciudad)<-[:SE_UBICA_EN]-(prov:Proveedor)
MATCH (c)-[:HA_CREADO]->(:Orden)-[:ESTA_COMPUESTA_DE]->(p:Producto)<-[:DISTRIBUIDO_POR]-(prov)
RETURN p.nombre AS producto, COUNT(p) AS Veces_Comprado
ORDER BY Veces_Comprado DESC